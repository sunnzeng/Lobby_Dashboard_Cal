---
title: "Untitled"
author: "Sunny"
date: "2020/9/5"
output: html_document
---

```{r}
library(dplyr)
library(ggcal)
library(knitr)
library(lubridate)
```

```{r}
#取出事件、開始時間、結束時間
data.frame(ntpuEvents[["items"]][["summary"]],ntpuEvents[["items"]][["start"]][["date"]],ntpuEvents[["items"]][["end"]][["date"]])-> ntpuEvents_time
```

```{r}
#變更名稱
colnames(ntpuEvents_time)<-c("Events","Start","End")
ntpuEvents_time

#按時間遞增排序
ntpuEvents_time%>%
  arrange(Start)-> ntpuEvents_time
ntpuEvents_time

#改變屬性
ymd(ntpuEvents_time$Start)->ntpuEvents_time$Start
ymd(ntpuEvents_time$End)->ntpuEvents_time$End

#分出各類事件
grep("考",ntpuEvents_time$Events)->row_test
grep("選課",ntpuEvents_time$Events)->row_class
grep("新生",ntpuEvents_time$Events)->row_fresh
grep("假",ntpuEvents_time$Events)->row_holiday

#選出各類事件
ntpuEvents_time[c(row_test),]->ntpuEvents_time_test
ntpuEvents_time[c(row_class),]->ntpuEvents_time_class
ntpuEvents_time[c(row_fresh),]->ntpuEvents_time_fresh
ntpuEvents_time[c(row_holiday),]->ntpuEvents_time_holiday

ntpuEvents_time_test%>%
  mutate(
    Category="考試"
  )->ntpuEvents_time_test

```


```{r}
library(ggplot2)
library(ggcal)

mydate <- seq(as.Date("2020-08-01"), as.Date("2021-08-31"), by="1 day")
myfill_test <- ntpuEvents_time_test$Start

print(ggcal(ntpuEvents_time_test$Start, ntpuEvents_time_test$Category))
```


```{r}
devtools::install_github("gadenbuie/ggweekly")

# create a calendar for April, May and June
library(ggweekly)
ggweek_planner(
  start_day = "2020-08-01", 
  end_day = "2020-08-31", 
)
```

```{r}
library(tidyverse)
library(dplyr)
library(purrr)
library(tidyr)
library(forcats)
library(ggplot2)
library(lubridate)
```

```{r}
#每周從星期一開始
options("lubridate.week.start" = 1)
```

```{r}
start_day <- floor_date(ymd("2019-06-24"), "week")
end_day   <- ymd("2019-08-16")
seq_days  <- seq(start_day, end_day, by = "day")

seq_days[1:5]
```

```{r}
dates <-
  tibble(
    day       = seq_days,
    wday_name = wday(day, label = TRUE, abbr = TRUE), #找出星期幾 1是週一 7是週日
    weekend   = wday(day) > 5,
    isoweek   = isoweek(day),
    month     = month(day, label = TRUE, abbr = FALSE),
    isoyear   = isoyear(day),
    week_year = fct_rev(sprintf("%s - %s", isoyear, isoweek)) 
  )
#fct_rev使week_year成為factor並反轉factor順序，使Y軸往下可以由小到大
dates
```

```{r}
dates %>% pull(week_year) %>% levels() %>% tail()
```

```{r}
day_one <- dates %>% 
  filter(day(day) == 1)

day_one
```

